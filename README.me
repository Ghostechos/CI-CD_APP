# Objectif du projet

Lâ€™objectif est de mettre en place une chaÃ®ne **CI/CD avec GitHub Actions** pour deux applications distinctes :

- **App1** : un site statique (HTML/CSS/JS) dÃ©ployÃ© automatiquement sur un serveur Linux via SSH et servi publiquement avec **Nginx**.  
- **App2** : une stack **LAMP** (WordPress + MariaDB + Adminer) conteneurisÃ©e avec Docker, destinÃ©e Ã  Ãªtre construite et publiÃ©e sous forme dâ€™image Docker sur **Docker Hub**.

Cette dÃ©marche permet dâ€™automatiser :

- lâ€™intÃ©gration du code,
- la validation par des tests,
- le dÃ©ploiement sur un environnement de prÃ©production/production.

---

## ğŸ“‚ Structure du projet

.
â”œâ”€â”€ app1/ # Site statique
â”‚ â””â”€â”€ index.html
â”‚
â”œâ”€â”€ app2/ # Stack LAMP
â”‚ â”œâ”€â”€ Dockerfile
â”‚ â”œâ”€â”€ docker-compose.yml
â”‚
â””â”€â”€ .github/workflows/
â”œâ”€â”€ app1.yml # CI/CD pour App1
â””â”€â”€ app2.yml # CI/CD pour App2



---

## âœ… DÃ©ploiement de App1

App1 est une application statique (site HTML) dÃ©ployÃ©e automatiquement avec GitHub Actions et servie via Nginx.

Le pipeline rÃ©alise :  
1. Transfert des fichiers via **SCP** sur le serveur distant.  
2. Installation/configuration de **Nginx** si nÃ©cessaire.  
3. Suppression de la configuration par dÃ©faut (`/etc/nginx/sites-enabled/default`).  
4. CrÃ©ation dâ€™une configuration dÃ©diÃ©e pointant vers `/var/www/app1`.  
5. RedÃ©marrage de Nginx et vÃ©rification de lâ€™accessibilitÃ© du site.  

ğŸ‘‰ RÃ©sultat : le site est fonctionnel et accessible depuis le serveur.

---

## âš ï¸ App2

- App2 nâ€™a pas encore Ã©tÃ© dÃ©ployÃ© complÃ¨tement.  
- Toutefois, tous les fichiers nÃ©cessaires sont dÃ©jÃ  prÃ©sents dans ce dÃ©pÃ´t :  
  - `Dockerfile` (pour personnaliser WordPress),  
  - `docker-compose.yml` (WordPress, MariaDB, Adminer),  
  - Workflow GitHub Actions (`app2.yml`) qui :  
    - construit et teste la stack,  
    - publie lâ€™image Docker sur **Docker Hub** (`yaspi97/app-tree`).  

ğŸ‘‰ Le pipeline est donc prÃªt, mais le dÃ©ploiement final nâ€™a pas encore Ã©tÃ© effectuÃ©.

---

## ğŸš§ ProblÃ¨mes rencontrÃ©s & Solutions

### 1. Connexion SSH refusÃ©e (App1)
- **ProblÃ¨me** : Le serveur demandait encore un mot de passe.  
- **Cause** : La clÃ© publique nâ€™Ã©tait pas ajoutÃ©e.  
- **Solution** : Ajout de la clÃ© publique dans `~/.ssh/authorized_keys` du serveur et configuration des secrets GitHub (`SSH_PRIVATE_KEY`, `SSH_HOST`, `SSH_USER`, `SSH_PORT`).  

### 2. Erreur YAML dans le workflow (App1)
- **ProblÃ¨me** : Le fichier `.github/workflows/app1.yml` ne passait pas la validation.  
- **Cause** : La configuration Nginx multi-lignes cassait lâ€™indentation YAML.  
- **Solution** : Utilisation dâ€™un `echo` (ou `cat <<EOF`) pour Ã©crire correctement la configuration dans `/etc/nginx/sites-available/app`.  

### 3. Page par dÃ©faut Nginx
- **ProblÃ¨me** : Lâ€™IP affichait encore la page par dÃ©faut de Nginx.  
- **Cause** : Le fichier `/etc/nginx/sites-enabled/default` Ã©tait encore actif.  
- **Solution** : Suppression automatique de ce fichier dans le workflow.  

### 4. Erreur 404 Not Found
- **ProblÃ¨me** : Nginx ne trouvait pas `index.html`.  
- **Cause** : La directive `root` pointait vers `/var/www/app` au lieu de `/var/www/app1`.  
- **Solution** : Correction de la configuration pour `root /var/www/app1;`.  

---

## ğŸ“ Remarque finale

- **App1 est terminÃ© et fonctionnel.**  
- **App2 nâ€™a pas encore Ã©tÃ© dÃ©ployÃ©**, mais tous les fichiers nÃ©cessaires sont prÃ©sents dans ce dÃ©pÃ´t.  
